<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<title>个人中心</title>
<link rel="stylesheet" href="css/style.css">        
</head>
<body>
<div id="loading">
    <div class="spinner">
    <div class="bounce1"></div>
    <div class="bounce2"></div>
    <div class="bounce3"></div>
    </div>
</div>
<section class="ng-scope">
    <div class="user_cap">
        <div class="expert_cap">
            <a href="home-intro.html">
                <img src="http://www.wingoalclub.com/static/ace/avatars/profile-pic.jpg">
            </a>
        </div>
        <p>未登录</p>
        <p>
            <small>马上登录有惊喜</small>
        </p>
    </div>
    <ul class="num_log ctr_txt">
        <li><a class="color-gray"><p class="user_like">-</p>关注</a></li>
        <li><a href="balance.html"><p class="user_blance">0.00</p>余额</a></li>
        <li><a class="color-gray"><p>-</p>优惠券</a></li>
        <li  class="color-gray"><p>-</p>粉丝</li>
    </ul>
</section>
<div class="help_site">
    <ul class="num_log my-act">
        <!--<li><a class="my_buy"><p>我购买的</p></a></li>-->
        <!--&lt;!&ndash;<li><a class="go_drawal"><p>去提现</p></a></li>&ndash;&gt;-->
        <!--<li><a class="go_charge" id="rechargeClick"><p>去充值</p></a></li>-->
        <!--<li><a class="site_auth"><p>站点认证</p></a></li>-->
        <!--<li><a class="my_refree"><p>我的邀请</p></a></li>-->
        <!--<li><a class="my_common_plan"><p>我的推荐</p></a></li>-->
        <!--<li><a class="my_common_plan"><p>活动福利</p></a></li>-->
        <!--<li><a class="my_diy_plan"><p>精彩推荐</p></a></li>-->
        <!--<li><a class="my_zhanZ_plan"><p>站主专区</p></a></li>-->
        <!---<li>余额<p>攻略</p></li>
            <li>优惠券<p>待定</p></li>
            <li>粉丝<p>待定</p></li>-->
            
        <li style="display: none"><a class="go_charge" jumpsrc="charge.html"><p>去充值</p></a></li>
        <li style="display: none"><a class="my_common_plan"><p>我的推荐</p></a></li>
        <li style="display: none"><a class="my_diy_plan"><p>精彩推荐</p></a></li>

    </ul>
    <!--<a href="help_list.html">
        <div class="help_link"><span>帮助</span></div>
    </a>-->
    <div class="off_btn btn_loginOut" style="display:none;"><span>退出</span></div>
</div>
<ul class="foot_nav">
    <li class="index"><a href="index.html">首页</a></li>
    <li class="recommend"><a href="recommend.html">推荐</a></li>
    <li class="score" style="display: none;"><a href="race-live.html">比分</a></li>
    <li class="active home"><a>我的</a></li>
</ul>
<script src="js/jquery.js" type="text/javascript"></script>
<script src="js/common.js?t=2017" type="text/javascript"></script>
<script>

$(function (){
    /*用户是否登录*/
    /*$.ajax({
        type:"get",
        url:"http://h5.wingoalclub.com/zucai/inf/isUserLogin",
        data:{},
        dataType:"json",
        error:function (){location.href="login.html";},
        success:function (data){
            if(data && data.status==200 && data.error == null){
                $(".btn_loginOut").show();
                loadUserinfo();
            }else{
                location.href="login.html";
            }
        }
    });*/
    if(localStorage.getItem("userLogin")!="login"){
        location.href="/login.html?refer="+encodeURIComponent(location.href);
    }else{
        $(".btn_loginOut").show();
        loadUserinfo();
    }
    /*获取用户信息*/
    function loadUserinfo(){
       $.ajax({
            type:"get",
            url:"http://h5.wingoalclub.com/zucai/inf/userInfo",
            data:{timer:new Date().getTime()},
            dataType:"json",
            success:function (d){
                if(d && d.status==200){
                    
                    var data=d.data;
                    var userName=data.userName || "用户";
                    var userIntro=data.selfIntroduce || "每天赢彩多一点！";
                    var balance=data.balances;

                    var userIntroHtml='<div class="expert_cap"><a href="home-intro.html"><img src=""></a></div><p>'+userName+'</p><p><small>'+userIntro+'</small></p>';
                    $(".user_cap").empty().html(userIntroHtml);
                    $(".user_blance").empty().html(balance);

                    /*
                    {
                        "userName":"用户名",
                        "realName":"真实姓名"，
                        "nickName":"昵称",
                        "mail":"邮箱",
                        "phone":"手机号码",
                        "cardType":"证件类型",
                        "cardNo":"证件号码",
                        "sex":"性别",
                        "address":"联系地址",
                        "postcode":"邮编",
                        "qq":"qq号码",
                        "selfIntroduce":"个人简介",
                        "winRate":"总胜率",
                        "balances":"用户余额"
                        }
                     */
                    var realname=data.realName || "";
                    var uesemail=data.mail || "";
                    var userphone=data.phone || "";
                    var usercardtype=data.cardType || "";
                    var usercardno=data.cardNo || "";
                    var usersex=data.sex || "";
                    var useraddress=data.address || "";
                    var userpostcode=data.postcode || "";
                    var userqq=data.qq || "";
                    var userselfIntroduce=data.selfIntroduce || "";
                    var userwinRate=data.winRate || "";

                    localStorage.setItem("username",userName);
                    localStorage.setItem("userbalance",balance);
                    localStorage.setItem("realname",realname);
                    localStorage.setItem("uesemail",uesemail);
                    localStorage.setItem("userphone",userphone);
                    localStorage.setItem("usercardtype",usercardtype);
                    localStorage.setItem("usercardno",usercardno);
                    localStorage.setItem("usersex",usersex);
                    localStorage.setItem("useraddress",useraddress);
                    localStorage.setItem("userpostcode",userpostcode);
                    localStorage.setItem("userqq",userqq);
                    localStorage.setItem("userselfIntroduce",userselfIntroduce);
                    localStorage.setItem("userwinRate",userwinRate);

                }else if(data.status=="001"){
                    location.href="/login.html?refer="+encodeURIComponent(location.href);
                }else{
                    alert(data.error);
                }
            }
        }); 
    }
    
    $(".btn_loginOut").click(function (){
        $.ajax({
            type:"get",
            url:"http://h5.wingoalclub.com/zucai/inf/logout",
            data:{timer:new Date().getTime()},
            dataType:"json",
            error:function (){alert("退出登录的时候出错了，请您稍后再试");},
            success:function (data){
                if(data && data.status==200 && data.error == null){
                    console.log("退出登录");
                    localStorage.setItem("userLogin","logon");
                    localStorage.clear();
                    location.href="http://"+location.host;
                }else{
                    var errormsg=data.error || "出现未知错误";
                    alert(errormsg);
                }
            }
        });
    });
    $(".go_charge").click(function (){
        openLink($(this).attr("jumpsrc"));
    });
});
</script>
</body>
</html>
